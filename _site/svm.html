<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>SVM</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">ML</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Cluster.html">Clustering</a>
</li>
<li>
  <a href="PCA.html">PCA</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Aprendizaje supervisado
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="glm.html">GLM</a>
    </li>
    <li>
      <a href="knn.html">KNN</a>
    </li>
    <li>
      <a href="decision_trees.html">Decision Trees</a>
    </li>
    <li>
      <a href="random_forest.html">Random Forest</a>
    </li>
    <li>
      <a href="svm.html">SVM</a>
    </li>
  </ul>
</li>
<li>
  <a href="GAM.html">GAM</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">SVM</h1>

</div>


<p>A continuación aplicaremos un modelo svm o support vector machine a nuestro grupo de datos. El algoritmo clasifica cada dato nuevo en el grupo que corresponda, según como consiga crear hiperplanos que separen de manera lineal los grupos de datos.</p>
<p>Cargamos las librerias y los datos que utilizaremos para el entrenamiento, con el conjunto de train, y la evaluación del modelo con el conjunto de test:</p>
<pre class="r"><code>library(class)
library(dplyr)
library(caret)
library (ROCR)
library(e1071)
source(&quot;funcs.R&quot;)</code></pre>
<pre class="r"><code>dataTrain &lt;- readRDS(&quot;datasetTrain.rds&quot;)
dataTest &lt;- readRDS(&quot;datasetTest.rds&quot;)</code></pre>
<p>Procedemos a despejar de los dataset (train y test) la variable objetivo original SalePrice. De la cual ya hemos creamos la variable GrupoPrecio, del tipo categorica. Separando asi por una parte un grupo de casas baratas y otro grupo de casas caras.</p>
<p>Nuestro modelo clasificará casas entre estos dos grupos.</p>
<pre class="r"><code>dataTrain &lt;- dataTrain %&gt;% dplyr::select(-SalePrice)
dataTest &lt;- dataTest %&gt;% dplyr::select(-SalePrice)</code></pre>
<p>Para este modelo se han escogido dos grupos de caracteristicas, para poder comproba como mejora si añadimos o quitamos variables al modelo. Estos dos grupos de caracteristicas las divideramos en group1 y group2.</p>
<pre class="r"><code>group1 &lt;- c(&#39;TotalSF&#39;,&#39;LotArea&#39;,&#39;GrupoPrecio&#39;)
group2 &lt;- c(&#39;TotalSF&#39;,&#39;LotArea&#39;,&#39;GrLivArea&#39;,&#39;GrupoPrecio&#39;)

dataTrain1 &lt;- dataTrain %&gt;% dplyr::select(group1)
dataTest1 &lt;- dataTest %&gt;% dplyr::select(group1)

dataTrain2 &lt;- dataTrain %&gt;% dplyr::select(group2)
dataTest2 &lt;- dataTest %&gt;% dplyr::select(group2)</code></pre>
<pre class="r"><code>XTrain1 &lt;- dataTrain1 %&gt;% dplyr::select(-GrupoPrecio)
YTrain1 &lt;- dataTrain1$GrupoPrecio

XTest1 &lt;- dataTest1 %&gt;% dplyr::select(-GrupoPrecio)
YTest1 &lt;- dataTest1$GrupoPrecio

XTrain2 &lt;- dataTrain2 %&gt;% dplyr::select(-GrupoPrecio)
YTrain2 &lt;- dataTrain2$GrupoPrecio

XTest2 &lt;- dataTest2 %&gt;% dplyr::select(-GrupoPrecio)
YTest2 &lt;- dataTest2$GrupoPrecio</code></pre>
<p>A continuación, entrenamos el modelo con el conjunto de entrenamiento y evaluamos con el conjunto de test, el primer grupo de caracteristicas escogidas (group1).</p>
<pre class="r"><code>#model &lt;- svm(formula = GrupoPrecio ~ ., data = dataTrain, kernel = &quot;linear&quot;, cost = 1, scale = TRUE)
model1 &lt;- best.tune(method = svm, train.x = GrupoPrecio ~ ., data = dataTrain1, ranges = list(cost = c(0.001, 0.01, 0.1, 1, 5, 10, 100)), kernel = &quot;radial&quot;, gamma = 1)

plot(model1, dataTrain1)</code></pre>
<p><img src="svm_files/figure-html/run_model-1.png" width="672" /></p>
<p>Debido a que este grupo solo contiene dos caracteristicas nos permite dibujar como el modelo svm divide el plano para clasificar los nuevos registros. Visualizamos también como se comporta el modelo con el conjunto de datos de test.</p>
<pre class="r"><code>pred1 &lt;- predict(model1, newdata = XTest1)
tab_test1 &lt;- table(pred1, YTest1, dnn = c(&quot;Actual&quot;, &quot;Predichos&quot;))
(tab_test1)</code></pre>
<pre><code>##         Predichos
## Actual   Barato Caro
##   Barato    648  106
##   Caro       16   19</code></pre>
<pre class="r"><code>draw_confusion_matrix(tab_test1, &quot;Actual&quot;, &quot;Predichos&quot;)</code></pre>
<p><img src="svm_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code>accuracy(tab_test1)</code></pre>
<pre><code>## [1] 84.53739</code></pre>
<pre class="r"><code>svm_test_error1 &lt;- calc_error_rate(predicted.value=pred1, true.value=YTest1)
(svm_test_error1)</code></pre>
<pre><code>## [1] 0.1546261</code></pre>
<pre class="r"><code>cm1 &lt;- confusionMatrix(tab_test1)
(cm1)</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##         Predichos
## Actual   Barato Caro
##   Barato    648  106
##   Caro       16   19
##                                           
##                Accuracy : 0.8454          
##                  95% CI : (0.8182, 0.8699)
##     No Information Rate : 0.8416          
##     P-Value [Acc &gt; NIR] : 0.4078          
##                                           
##                   Kappa : 0.1807          
##                                           
##  Mcnemar&#39;s Test P-Value : 7.776e-16       
##                                           
##             Sensitivity : 0.9759          
##             Specificity : 0.1520          
##          Pos Pred Value : 0.8594          
##          Neg Pred Value : 0.5429          
##              Prevalence : 0.8416          
##          Detection Rate : 0.8213          
##    Detection Prevalence : 0.9556          
##       Balanced Accuracy : 0.5640          
##                                           
##        &#39;Positive&#39; Class : Barato          
## </code></pre>
<p>A continuación se realizara todos los pasos anteriores pero esta vez con otro conjunto de caracteristicas. Este conjunto dispone de más caracteristicas por lo que no podremos visualizar como separa el plano de caracteristicas. Podremos ver cuales de los dos modelos SVM funciona mejor.</p>
<pre class="r"><code>model2 &lt;- best.tune(method = svm, train.x = GrupoPrecio ~ ., data = dataTrain2, ranges = list(cost = c(0.001, 0.01, 0.1, 1, 5, 10, 100)), kernel = &quot;radial&quot;, gamma = 1)</code></pre>
<pre class="r"><code>pred2 &lt;- predict(model2, newdata = XTest2)
tab_test2 &lt;- table(pred2, YTest2, dnn = c(&quot;Actual&quot;, &quot;Predichos&quot;))
(tab_test2)</code></pre>
<pre><code>##         Predichos
## Actual   Barato Caro
##   Barato    649  102
##   Caro       15   23</code></pre>
<pre class="r"><code>draw_confusion_matrix(tab_test2, &quot;Actual&quot;, &quot;Predichos&quot;)</code></pre>
<p><img src="svm_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code>accuracy(tab_test2)</code></pre>
<pre><code>## [1] 85.1711</code></pre>
<pre class="r"><code>svm_test_error2 &lt;- calc_error_rate(predicted.value=pred2, true.value=YTest2)
(svm_test_error2)</code></pre>
<pre><code>## [1] 0.148289</code></pre>
<pre class="r"><code>cm2 &lt;- confusionMatrix(tab_test2)
(cm2)</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##         Predichos
## Actual   Barato Caro
##   Barato    649  102
##   Caro       15   23
##                                          
##                Accuracy : 0.8517         
##                  95% CI : (0.825, 0.8758)
##     No Information Rate : 0.8416         
##     P-Value [Acc &gt; NIR] : 0.2339         
##                                          
##                   Kappa : 0.225          
##                                          
##  Mcnemar&#39;s Test P-Value : 1.855e-15      
##                                          
##             Sensitivity : 0.9774         
##             Specificity : 0.1840         
##          Pos Pred Value : 0.8642         
##          Neg Pred Value : 0.6053         
##              Prevalence : 0.8416         
##          Detection Rate : 0.8226         
##    Detection Prevalence : 0.9518         
##       Balanced Accuracy : 0.5807         
##                                          
##        &#39;Positive&#39; Class : Barato         
## </code></pre>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
